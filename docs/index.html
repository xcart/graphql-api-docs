<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="index GraphQL documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>index</title>
    <link rel="stylesheet" href="/graphql-api-docs/assets/style.css">
    <link rel="stylesheet" href="/graphql-api-docs/assets/style_fix.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js"></script>
    <script>

    // Add anchors on DOMContentLoaded
    document.addEventListener("DOMContentLoaded", function(event) {
      anchors.options = {
        placement: 'left',
        visible: 'hover',
        icon: '¶'
      };
      anchors.add('h2, h3, h4, h5, h6, .anchored');
    });

    </script>
  </head>
  <body>

    <div id="wrap">
      <div id="header">
      </div>
      <div id="sidebar">
        <ul class="categories">
  <li>
    <ul class="menu-root">
      <li>
        <a href="/graphql-api-docs">GraphQL Reference</a>
    </ul>
  </li>

  <li>
    <p>Queries</p>
    <ul class="menu-root">
      <li>
        <a href="/graphql-api-docs/operation/query/" class="sidebar-link">
          Query
        </a>
      </li>
      <li>
        <a href="/graphql-api-docs/operation/mutation/" class="sidebar-link">
          Mutation
        </a>
      </li>
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/object">Objects</a></p>
    <ul class="menu-root">
      
        
      <li>
        <a href="/graphql-api-docs/object/__directive/" class="sidebar-link">
          __Directive
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/__enumvalue/" class="sidebar-link">
          __EnumValue
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/__field/" class="sidebar-link">
          __Field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/__inputvalue/" class="sidebar-link">
          __InputValue
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/__schema/" class="sidebar-link">
          __Schema
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/__type/" class="sidebar-link">
          __Type
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/address/" class="sidebar-link">
          address
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/app_config/" class="sidebar-link">
          app_config
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/app_data/" class="sidebar-link">
          app_data
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/banner/" class="sidebar-link">
          banner
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/cart/" class="sidebar-link">
          cart
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/category/" class="sidebar-link">
          category
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/collection/" class="sidebar-link">
          collection
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/country/" class="sidebar-link">
          country
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/coupon/" class="sidebar-link">
          coupon
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/currency/" class="sidebar-link">
          currency
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/faq/" class="sidebar-link">
          faq
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/homepagewidget/" class="sidebar-link">
          homePageWidget
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/language/" class="sidebar-link">
          language
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/membership/" class="sidebar-link">
          membership
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/module/" class="sidebar-link">
          module
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/offer/" class="sidebar-link">
          offer
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/orderitem/" class="sidebar-link">
          orderItem
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/order_item_options/" class="sidebar-link">
          order_item_options
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/payment/" class="sidebar-link">
          payment
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/payment_field/" class="sidebar-link">
          payment_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product/" class="sidebar-link">
          product
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product_attribute/" class="sidebar-link">
          product_attribute
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product_attribute_group/" class="sidebar-link">
          product_attribute_group
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product_option/" class="sidebar-link">
          product_option
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product_option_value/" class="sidebar-link">
          product_option_value
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/product_sticker/" class="sidebar-link">
          product_sticker
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/profile_field/" class="sidebar-link">
          profile_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/registrationresult/" class="sidebar-link">
          registrationResult
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/select_field/" class="sidebar-link">
          select_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/select_field_value/" class="sidebar-link">
          select_field_value
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/shipping/" class="sidebar-link">
          shipping
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/state/" class="sidebar-link">
          state
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/switch_field/" class="sidebar-link">
          switch_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/text_field/" class="sidebar-link">
          text_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/user/" class="sidebar-link">
          user
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/value_range_field/" class="sidebar-link">
          value_range_field
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/widgetparams/" class="sidebar-link">
          widgetParams
        </a>
      </li>
      
        
      <li>
        <a href="/graphql-api-docs/object/wishlist/" class="sidebar-link">
          wishlist
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/operation/mutation">Mutations</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/mutation/addcartcoupon/" class="sidebar-link">
          addCartCoupon
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/addproducttocart/" class="sidebar-link">
          addProductToCart
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/addproducttowishlist/" class="sidebar-link">
          addProductToWishlist
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/auth/" class="sidebar-link">
          auth
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changeaddress/" class="sidebar-link">
          changeAddress
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changecustomernotes/" class="sidebar-link">
          changeCustomerNotes
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changeitemamount/" class="sidebar-link">
          changeItemAmount
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changeitemamountbymodifier/" class="sidebar-link">
          changeItemAmountByModifier
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changepaymentfields/" class="sidebar-link">
          changePaymentFields
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changepaymentmethod/" class="sidebar-link">
          changePaymentMethod
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changeshippingmethod/" class="sidebar-link">
          changeShippingMethod
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/changeuseraddress/" class="sidebar-link">
          changeUserAddress
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/contactus/" class="sidebar-link">
          contactUs
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/deleteuseraddress/" class="sidebar-link">
          deleteUserAddress
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/putoffer/" class="sidebar-link">
          putOffer
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/recoverpassword/" class="sidebar-link">
          recoverPassword
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/register/" class="sidebar-link">
          register
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/removecartcoupon/" class="sidebar-link">
          removeCartCoupon
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/removecartitem/" class="sidebar-link">
          removeCartItem
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/removeproductfromwishlist/" class="sidebar-link">
          removeProductFromWishlist
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/selectaddress/" class="sidebar-link">
          selectAddress
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/signupfornews/" class="sidebar-link">
          signUpForNews
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/mutation/updateuserregisterdata/" class="sidebar-link">
          updateUserRegisterData
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/interface">Interfaces</a></p>
    <ul class="menu-root">
      
        
        <li>
          <a href="/graphql-api-docs/interface/collection_item/" class="sidebar-link">
            collection_item
          </a>
        </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/enum">Enums</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/enum/__directivelocation/" class="sidebar-link">
          __DirectiveLocation
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/__typekind/" class="sidebar-link">
          __TypeKind
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/address_type_enum/" class="sidebar-link">
          address_type_enum
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/cart_error/" class="sidebar-link">
          cart_error
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/collection_type/" class="sidebar-link">
          collection_type
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/form_field_type/" class="sidebar-link">
          form_field_type
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/enum/user_type/" class="sidebar-link">
          user_type
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/union">Unions</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/union/category_products_filter/" class="sidebar-link">
          category_products_filter
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/input_object">Input Objects</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/input_object/authinput/" class="sidebar-link">
          AuthInput
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/clientinput/" class="sidebar-link">
          ClientInput
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/userregisterinput/" class="sidebar-link">
          UserRegisterInput
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/userupdateinput/" class="sidebar-link">
          UserUpdateInput
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/address_input/" class="sidebar-link">
          address_input
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/list_order_filter/" class="sidebar-link">
          list_order_filter
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/payment_fields_input/" class="sidebar-link">
          payment_fields_input
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/products_filter_input/" class="sidebar-link">
          products_filter_input
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/input_object/value_range_input/" class="sidebar-link">
          value_range_input
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/scalar">Scalars</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/scalar/boolean/" class="sidebar-link">
          Boolean
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/scalar/float/" class="sidebar-link">
          Float
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/scalar/id/" class="sidebar-link">
          ID
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/scalar/int/" class="sidebar-link">
          Int
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/scalar/string/" class="sidebar-link">
          String
        </a>
      </li>
      
    </ul>
  </li>

  <li>
    <p><a href="/graphql-api-docs/directive">Directives</a></p>
    <ul class="menu-root">
      
      
      <li>
        <a href="/graphql-api-docs/directive/deprecated/" class="sidebar-link">
          deprecated
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/directive/include/" class="sidebar-link">
          include
        </a>
      </li>
      
      
      <li>
        <a href="/graphql-api-docs/directive/skip/" class="sidebar-link">
          skip
        </a>
      </li>
      
    </ul>
  </li>
</ul>

      </div>
      <div id="content">

        <h1>
<a id="graphql-api-connector-documentation" class="anchor" href="#graphql-api-connector-documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>GraphQL API Connector Documentation</h1>
<ul>
<li><a href="#authentication">Authentication</a></li>
<li><a href="#module-related-queries">Module-related queries</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#checkout-flow">Checkout flow</a></li>
</ul>
<p>X-Cart 5 can be enhanced with the following add-ons to provide GraphQL compatible catalog API, suitable for making alternative frontend apps (e.g. mobile apps):</p>
<ul>
<li>QSL\GraphQLApi (v5.4.0)</li>
<li>QSL\MobileApp (v.5.4.0)</li>
</ul>
<p>These add-ons don’t provide the capability to allow for an admin-level application yet but can be easily extended to add more queries and mutations.</p>
<p>The API endpoint is available at <code>//&lt;hostname&gt;/admin.php?target=graphql_api</code></p>
<p>You can explore it via such solutions like <a href="https://github.com/graphql/graphiql">GraphiQL</a> (also, Chrome extension <a href="https://chrome.google.com/webstore/detail/chromeiql/fkkiamalmpiidkljmicmjfbieiclmeij">ChromeiQL</a>) or by using the compiled documentation <a href="https://xcart.github.io/graphql-api-docs/query.doc.html">https://xcart.github.io/graphql-api-docs/query.doc.html</a>.</p>
<p>X-Cart also maintains a demo store which can be used to test the API connection: <a href="https://mobile.x-cart.com/admin.php?target=graphql_api">https://mobile.x-cart.com/admin.php?target=graphql_api</a></p>
<p>This demo store storefront can be accessed by the URL: <a href="https://mobile.x-cart.com/">https://mobile.x-cart.com.</a></p>
<p>The API can be easily integrated via such solutions like the whole universe of different Apollo Clients (<a href="https://www.apollographql.com/">https://www.apollographql.com/</a>).</p>
<h2>
<a id="authentication" class="anchor" href="#authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authentication</h2>
<p>Request authentication is JWT-based. Most of the query objects can be accessed without any token - replicating how the website storefront can be accessed. User-related data, such as customer orders information, address and personal can only be accessed by providing the user JWT token.</p>
<p>Do not provide any token if you’re not sure if it’s the valid one. If invalid token is presented, the API won’t allow access to any information, even if it doesn’t require a token.</p>
<p>Any requests to protected areas should include a special GraphQL variable called <code>context</code>.</p>
<p>This variable should be an object of the following string fields:</p>
<ul>
<li>jwt: Client JWT token</li>
<li>cur: Currency 2-char code</li>
<li>lng: Language 2-char code</li>
</ul>
<h3>
<a id="receiving-token-for-registered-user" class="anchor" href="#receiving-token-for-registered-user" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Receiving token for registered user</h3>
<p>The JWT can be received via the following mutation:</p>
<pre><code>mutation Auth($auth: AuthInput!) {
  auth(auth: $auth)
}
</code></pre>
<p>Variables:</p>
<pre><code>{
  "auth": {
    "login": "test@example.com",
    "password": "test"
  }
}
</code></pre>
<p>As you can see, $auth should be an object of the following string fields:</p>
<ul>
<li>login</li>
<li>password</li>
</ul>
<p>If the login \ password is correct, this request will return the similar output:</p>
<pre><code>{
  "data": {
    "auth": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VyX2lkIjo1ODYsImFjY2VzcyI6ImN1c3RvbWVyIiwiZXhwaXJlIjoiMjAxOS0wNi0xOFQxNTo0NDoxMyswNDowMCJ9.DrGeyReowpizC8UKQRuIK34-CtHXxglkPVOVfyn1FHft0udXKPYqIQJgPJ15jBylYvmcWa13JolICXTkJpuPuQ"
  }
}
</code></pre>
<h3>
<a id="receiving-token-for-anonymous-user" class="anchor" href="#receiving-token-for-anonymous-user" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Receiving token for anonymous user</h3>
<p>By default, no persistent data is being stored by the backend during API access, therefore there are no tokens and cart ids. However, right after a successful mutation that changes the cart to be non-empty (e.g. after adding the product to cart), the <code>cart</code> object will have a <code>token</code> param which can be used to continue making requests with a single session. Temporary anonymous user will be created on the backend.</p>
<p>For instance, you can receive a jwt after making such mutation:</p>
<pre><code>mutation {
    addProductToCart(product_id: 7) {
        id
        token
        total_amount
    }
}
</code></pre>
<p>The result will contain a token to be used in the next requests:</p>
<pre><code>{
    "data": {
        "addProductToCart": {
            "id": "119",
            "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJ1c2VyX2lkIjoyMjAsImFjY2VzcyI6ImFub255bW91cyIsImV4cGlyZSI6IjIwMjAtMDMtMjZUMDc6MTA6MTIrMDA6MDAifQ.BI6l2nvL34N5CpIN3dOVOcCMaQQJ5uJlnVG2Hbyh-6521jojDw3hDDA60mP88mocnoHw0HWsAwus2VcXRHH0Ue2lwda5LRSVG-lnT7hUhwgcerz8_l59Ekgdm8iu9vHHU_kYDFGHLUPc_gemgunVLzwfCCXVxAup_ggoBLoVjOY5mZeMH3li6vgW0PCCmJB6HbkaYEbh_SwgDi9N2LkcmGp4olArU130muEUN6eNPZZp_saKus0bhw24x9hkVDe80f2DRl38lteLvy20Rvy8_ljKAWl1Syh7gXRvvTAEiV7eKMzUdKcrrQgjLfGOxHAPUei2640Z2SgA8Ks2EA-9Fg",
            "total_amount": 1
        }
    }
}
</code></pre>
<h3>
<a id="token-usage" class="anchor" href="#token-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Token usage</h3>
<p>You can use received jwt string in order to get access to any protected user information simply by including <code>context</code> variable in all requests:</p>
<pre><code>{
  "context": {
    "jwt": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ1c2VyX2lkIjo1ODYsImFjY2VzcyI6ImN1c3RvbWVyIiwiZXhwaXJlIjoiMjAxOS0wNi0xOFQxNTo0NDoxMyswNDowMCJ9.DrGeyReowpizC8UKQRuIK34-CtHXxglkPVOVfyn1FHft0udXKPYqIQJgPJ15jBylYvmcWa13JolICXTkJpuPuQ"
  }
}
</code></pre>
<p>The alternative way to provide context information is via HTTP request headers. Use:</p>
<ul>
<li>
<strong>X-App-Token</strong> to provide JWT string with token</li>
<li>
<strong>X-App-Currency</strong> to provide currency code</li>
<li>
<strong>X-App-Language</strong> to provide language code</li>
</ul>
<p>The headers are being checked only if there is no <strong>context</strong> variable in the request.</p>
<p>There is no permission information provided via <code>auth</code> mutation, and the overall scheme can differ only between anonymous and registered user. The auth scheme can be improved to allow for different access levels or available permission, but that will require some modifications.</p>
<p>Each response object has the obligatory <code>data</code> property and can include <code>errors</code> property:</p>
<pre><code>{
  "data": {
    "auth": null
  },
  "errors": [
    {
      "message": "Access denied.",
      "locations": [
        {
          "line": 2,
          "column": 3
        }
      ],
      "path": [
        "auth"
      ]
    }
  ]
}
</code></pre>
<p>The API access isn’t protected with external application identifiers check - but this can be improved with some custom modification.</p>
<h2>
<a id="module-related-queries" class="anchor" href="#module-related-queries" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Module-related queries</h2>
<p>Some queries in this GraphQL API are being exclusively resolved by various X-Cart addons, e.g. My Wishlist addon, Put an Offer addon. In case when required module is not enabled in the system, the API will return the similar response:</p>
<pre><code>{
  "data": {
    "wishlist": null
  },
  "errors": [
    {
      "message": "No module",
      "locations": [
        {
          "line": 2,
          "column": 3
        }
      ],
      "path": [
        "wishlist"
      ]
    }
  ]
}
</code></pre>
<p>The data object will contain null property and the errors will have the message “No module” - that distinguishes the state when the module is required to be enabled on the store backend and until that the following feature should be disabled in the connected system.</p>
<p>You can also fetch the list of the installed addons in order to control the available functionality in your app:</p>
<pre><code>{
  appData {
    modules {
      name
      enabled
    }
  }
}
</code></pre>
<p>When the certain addon name (e.g. QSL-MyWishlist) is either non-present in the list or marked as disabled, you can safely disable the corresponding features in your app.</p>
<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>
<p>Here are the few examples of making GraphQL queries:</p>
<h3>
<a id="getting-the-collection-of-products-filtered-by-some-criteria" class="anchor" href="#getting-the-collection-of-products-filtered-by-some-criteria" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting the collection of products filtered by some criteria</h3>
<pre><code>query ($filters: products_filter_input) {
  collection(from: 0, size: 100, type: products, filters: $filters) {
    count
    objects {
      id
      ... on product {
        product_name
        price
        available
      }
    }
  }
}
</code></pre>
<p>With the variables:</p>
<pre><code>{
  "filters": {
    "featured": true
  }
}
</code></pre>
<h3>
<a id="searching-for-products" class="anchor" href="#searching-for-products" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Searching for products</h3>
<p>Use the <a href="#getting-the-collection-of-products-filtered-by-some-criteria">Getting the collection of products</a> request with the following filters:</p>
<p>With the variables:</p>
<pre><code>{
  "filters": {
    "searchFilter": "substring"
  }
}
</code></pre>
<h3>
<a id="getting-user-data-requires-auth" class="anchor" href="#getting-user-data-requires-auth" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting user data (requires auth)</h3>
<pre><code>query {
  user {
    login
    enabled
    first_name
    last_name
    contact_us_url
    account_details_url
    orders_list_url
    address_book_url
    messages_url
  }
}
</code></pre>
<p>Variables</p>
<pre><code>{
  "context": {
    "jwt": "&lt;...large string of jwt token...&gt;"
  }
}
</code></pre>
<p>The <code>*_url</code> fields return a special URL leading to a stripped-down mobile-ready version of the page (suitable for WebView).</p>
<h3>
<a id="getting-language-information" class="anchor" href="#getting-language-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting language information</h3>
<pre><code>query {
  appConfig {
    default_language {
      code
      name
    }
  }
  user {
    language
  }
}
</code></pre>
<h3>
<a id="getting-product-collections-metadata" class="anchor" href="#getting-product-collections-metadata" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting product collections metadata</h3>
<pre><code>query {
  appData {
    home_page_widgets {
      display_name
      service_name
      enabled
      type
      params {
        filters
      }
    }
  }
}
</code></pre>
<p>The path <code>appData.home_page_widgets.params.filters</code> contains JSON-encoded string of <code>"filters"</code>to use in query variables in order to obtain certain collection.</p>
<h3>
<a id="getting-wishlist-data-requires-auth" class="anchor" href="#getting-wishlist-data-requires-auth" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting wishlist data (requires auth)</h3>
<pre><code>{
  wishlist {
    id
    user_id
    items {
      id
      product_name
    }
    count
  }
}
</code></pre>
<h3>
<a id="register-new-user" class="anchor" href="#register-new-user" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Register new user</h3>
<pre><code>mutation($data: UserRegisterInput!) {
  register(data: $data) {
    jwt
    user {
      id
    }
  }
}
</code></pre>
<p>Variables</p>
<pre><code>{
    "data": {
    "email": "test@asdasd.com",
    "password": "123456789",
    "password_conf": "123456789",
    "login": "test@asdasd.com",
    "first_name": "Test",
    "last_name": "Test lastname",
    "company": "Company",
    "url": "https://asdasd.com",
    "tax_number": "123124124"
  }
}
</code></pre>
<h3>
<a id="read-user-address-book-auth-protected" class="anchor" href="#read-user-address-book-auth-protected" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Read user address book (auth protected)</h3>
<pre><code>{
    user {
        id
        address_list {
            id
            first_name
            last_name
            country {
                code
                name
            }
            state {
                code
                name
            }
            county # alternative to "state" if "country" obj doesn't have states
            city
            address
            zip
            phone
        }
    }
}
</code></pre>
<p><br>
Result:</p>
<pre><code>{
  "data": {
        "user": {
            "id": "7",
            "address_list": [
                {
                    "id": "357",
                    "first_name": "Vasya",
                    "last_name": "Pupkin",
                    "country": {
                        "code": "US",
                        "name": "United States"
                    },
                    "state": {
                        "code": "CA",
                        "name": "California"
                    },
                    "county": "",
                    "city": "Los Angeles",
                    "address": "1 E asdasd st 222",
                    "zip": "90001",
                    "phone": "+2 232323232"
                }
            ]
        }
    }
}
</code></pre>
<h3>
<a id="update-address-in-address-book-auth-protected" class="anchor" href="#update-address-in-address-book-auth-protected" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Update address in address book (auth protected)</h3>
<pre><code>mutation($address: address_input!) {
  changeUserAddress(address_id: 7, address: $address) {
      address_list {
          id
          city
      }
  }
}
</code></pre>
<p>Variables:</p>
<pre><code>{
  "address": {
     "city": "Another City"
  }
}
</code></pre>
<h3>
<a id="delete-address-from-address-book-auth-protected" class="anchor" href="#delete-address-from-address-book-auth-protected" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Delete address from address book (auth protected)</h3>
<pre><code>mutation {
  deleteUserAddress(address_id: 7) {
      address_list {
          id
      }
  }
}
</code></pre>
<h2>
<a id="checkout-flow" class="anchor" href="#checkout-flow" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Checkout flow</h2>
<p>The API can be used to place orders on the store and provide a customer with an ability to perform the payment on the selected payment processor page. Due to complexity, it has to be implemented in a certain way. The general flow is based on the UI, split by 3 major steps:</p>
<ul>
<li>Specifying shipping\billing addresses,</li>
<li>Choosing the shipping option,</li>
<li>Selecting the payment method.</li>
</ul>
<p>The API is ready to place order once <strong>cart</strong> object has its <strong>checkout_ready</strong> property set to <strong>true.</strong> The UI must allow customer to fill all the required data in order to achieve this. You can retrieve the list of the problems, preventing the checkout, from the <strong>errors</strong> array:</p>
<ul>
<li>EMPTY_CART</li>
<li>NO_PAYMENT_SELECTED</li>
<li>NO_SHIPPING_SELECTED</li>
<li>NO_SHIPPING_AVAILABLE</li>
<li>NO_SHIPPING_ADDRESS</li>
</ul>
<p>Communication protocol is usually the following:</p>
<ol>
<li>Retrieve latest cart state by using <a href="#checkoutshippingpagequery">CheckoutShippingPageQuery</a>
</li>
<li>Specify the address with <a href="#changeshippingaddress-mutation-might-change-both-addresses">ChangeShippingAddress</a> mutation (this might also change billing address &amp; shipping methods, so we refetch this data too)
<ol>
<li>You can also change billing address by changing mutation type to “billing”</li>
<li>Alternatively, you can select one of the existing address by using SelectAddress mutation.</li>
</ol>
</li>
<li>Choose shipping option with <a href="#changeshippingmethod-mutation">ChangeShippingMethod</a> mutation</li>
<li>Refresh the state with <a href="#checkoutpaymentpagequery">CheckoutPaymentPageQuery</a>
</li>
<li>Select payment method with <a href="#changepaymentmethod-mutation">ChangePaymentMethod</a> mutation</li>
<li>Set payment options (if required) with <a href="#changepaymentfields-mutation">ChangePaymentFields</a> mutation</li>
<li>(OPTIONAL) Set customer notes with <a href="#changecustomernotes-mutation">ChangeCustomerNotes</a> mutation</li>
</ol>
<p>Once these steps are done and the cart is in <code>checkout_ready = true</code> state, you should render a WebView by the <strong>checkout_url</strong> URL with the following injected JS patch:</p>
<pre><code>(function() {
     var originalPostMessage = window.postMessage;

     var patchedPostMessage = function(message, targetOrigin, transfer) {
       originalPostMessage(message, targetOrigin, transfer);
     };

     patchedPostMessage.toString = function() {
       return String(Object.hasOwnProperty).replace('hasOwnProperty', 'postMessage');
     };

     window.postMessage = patchedPostMessage;
   })();
</code></pre>
<p>The aforementioned WebView should handle onMessage, receiving the order stats in the <strong>responseData</strong> object:</p>
<pre><code>{
  "message": ...,
  "order":{},
  "success": ...
}
</code></pre>
<p><br>
This data will allow you to render a proper final screen with order details.</p>
<h3>
<a id="payment-method-options" class="anchor" href="#payment-method-options" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Payment method options</h3>
<p>You can retrieve available payment options from <strong>payment_methods</strong> prop of the <strong>cart</strong> object:</p>
<pre><code>  cart {
    id
    user {
      email
    }
    items {
      id
    }
    payment_methods {
      id
      service_name
      payment_name
      details
      fields {
        id
        name
        value
      }
    }
  }
</code></pre>
<p>In general, all payment_methods won’t require any fields to set up before performing checkout, but you might receive the similar <strong>payment_method</strong> object:</p>
<pre><code>        {
          "id": "5",
          "service_name": "Echeck",
          "payment_name": "Check",
          "details": "Check payment",
          "fields": [
            {
              "id": "check_routing_number",
              "name": "ABA routing number",
              "value": ""
            },
            {
              "id": "check_acct_number",
              "name": "Bank Account Number",
              "value": ""
            },
            {
              "id": "check_type",
              "name": "Type of Account",
              "value": ""
            },
            {
              "id": "check_bank_name",
              "name": "Bank name",
              "value": ""
            },
            {
              "id": "check_acct_name",
              "name": "Name of account holder",
              "value": ""
            },
            {
              "id": "check_number",
              "name": "Check number",
              "value": ""
            }
          ]
        },
</code></pre>
<p>In order to perform successful checkout with such method, you have perform a <a href="#changepaymentfields-mutation">ChangePaymentFields mutation</a> with a similar request:</p>
<pre><code>mutation ($fields: [payment_fields_input]!) {
  changePaymentFields(fields: $fields) {
    payment {
      id
      service_name
      fields {
        id
        name
        value
      }
    }
  }
}
</code></pre>
<p>With vars:</p>
<pre><code>{
  "fields": [{
    "id": "check_routing_number",
    "value": "123456789"
  }],
  "context": {    "jwt":"....jwt...."
  }
}
</code></pre>
<h3>
<a id="checkout-related-queries--mutations" class="anchor" href="#checkout-related-queries--mutations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Checkout-related Queries &amp; Mutations</h3>
<h4>
<a id="checkoutshippingpagequery" class="anchor" href="#checkoutshippingpagequery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CheckoutShippingPageQuery</h4>
<pre><code>query CheckoutShippingPageQuery {
  cart {
    id
    token
    total
    total_amount
    errors
    checkout_ready
    checkout_url
    shipping {
      id
      rate
    }
    payment {
      id
    }
    shipping_address {
      id
      email
      first_name
      last_name
      address
      city
      state {
        code
        name
      }
      country {
        code
        name
      }
      zip
      phone
    }
    billing_address {
      id
      email
      first_name
      last_name
      address
      city
      state {
        code
        name
      }
      country {
        code
        name
      }
      zip
      phone
    }
    shipping_methods {
      id
      shipping_name
      rate
    }
    payment_methods {
      id
    }
  }
}
</code></pre>
<h4>
<a id="changeshippingmethod-mutation" class="anchor" href="#changeshippingmethod-mutation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ChangeShippingMethod mutation</h4>
<pre><code>mutation ChangeShippingMethod($shippingMethodId: ID!) {
   changeShippingMethod (shipping_id: $shippingMethodId) {
     id
     total
     errors
     checkout_ready
     shipping {
       id
       rate
     }
     shipping_methods {
       id
       shipping_name
       rate
     }
   }
 }
</code></pre>
<h4>
<a id="changeshippingaddress-mutation-might-change-both-addresses" class="anchor" href="#changeshippingaddress-mutation-might-change-both-addresses" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ChangeShippingAddress mutation (might change both addresses)</h4>
<pre><code>mutation ChangeShippingAddress($address: address_input!) {
   changeAddress (type: "shipping", address: $address) {
     id
     total
     errors
     checkout_ready
     shipping {
       id
       rate
     }
     shipping_address {
       id
       email
       first_name
       last_name
       address
       city
       state {
         code
         name
       }
       country {
         code
         name
       }
       zip
       phone
     }
     billing_address {
       id
       email
       first_name
       last_name
       address
       city
       state {
         code
         name
       }
       country {
         code
         name
       }
       zip
       phone
     }
     shipping_methods {
       id
       shipping_name
       rate
     }
     payment_methods {
       id
     }
   }
 }
</code></pre>
<p>The <strong>address</strong>variable should contain <strong>country_code</strong>, <strong>state_code</strong>properties as 2-char ISO codes, e.g. “US”, “AZ”. Example:</p>
<pre><code> "address": {
    "email": "bit-bucket@x-cart.com",
    "country_code": "US",
    "state_code": "CA",
    "first_name": "Vasya",
    "last_name": "Petrov",
    "county": "California",
    "city": "Los Angeles",
    "phone": "+18005550505",
    "zipcode": "90001",
  },
</code></pre>
<h4>
<a id="checkoutpaymentpagequery" class="anchor" href="#checkoutpaymentpagequery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CheckoutPaymentPageQuery</h4>
<pre><code>query CheckoutPaymentPageQuery {
 cart {
   id
   token
   total
   checkout_ready
   checkout_url
   errors
   payment {
     id
     fields {
       id
       name
     }
   }
   payment_methods {
     id
     service_name
     payment_name
     details
     fields {
       id
       name
       value
     }
   }
 }
}
</code></pre>
<h4>
<a id="changepaymentmethod-mutation" class="anchor" href="#changepaymentmethod-mutation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ChangePaymentMethod mutation</h4>
<pre><code>mutation ChangePaymentMethod($paymentMethodId: ID!) {
   changePaymentMethod (payment_id: $paymentMethodId) {
     id
     payment {
       id
       fields {
         id
         name
         value
       }
     }
   }
 }
</code></pre>
<h4>
<a id="changepaymentfields-mutation" class="anchor" href="#changepaymentfields-mutation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ChangePaymentFields mutation</h4>
<pre><code>mutation ChangePaymentFields($fields: [payment_fields_input]!) {
   changePaymentFields (fields: $fields) {
     id
     payment {
       id
       fields {
         id
         name
         value
       }
     }
   }
 }
</code></pre>
<h4>
<a id="changecustomernotes-mutation" class="anchor" href="#changecustomernotes-mutation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ChangeCustomerNotes mutation</h4>
<pre><code>mutation ChangeShippingMethod($notes: String!) {
   changeCustomerNotes (notes: $notes) {
     id
     notes
   }
 }
</code></pre>
<h3>
<a id="coupons-feature-requires-coupons-add-on" class="anchor" href="#coupons-feature-requires-coupons-add-on" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Coupons feature (requires "Coupons" add-on)</h3>
<p>You can add coupons to the cart by using <strong>addCartCoupon(code)</strong> mutation and remove coupons by using <strong>removeCartCoupon(code)</strong>  mutation. If coupon is valid, it will be applied to the cart and the cart <strong>total</strong> value will be changed.</p>
<p>The <strong>coupons</strong>property of the cart will contain currently applied coupons.</p>
<p>Also, there is a list of error messages in case coupon code is invalid or cannot be applied for a reason (the message is translated according to the current language):</p>
<ul>
<li>No coupon for <strong>CODE</strong>
</li>
<li>Sorry, the coupon you entered is invalid. Make sure the coupon code is spelled correctly</li>
<li>Sorry, the coupon has expired</li>
<li>Sorry, the coupon use limit has been reached</li>
<li>You have already used the coupon</li>
<li>This coupon cannot be combined with other coupons</li>
<li>Sorry, this coupon cannot be combined with the coupon already applied. Revome the previously applied coupon and try again.</li>
<li>To use the coupon, your order subtotal must be between <strong>X</strong> and <strong>Y</strong>
</li>
<li>To use the coupon, your order subtotal must be at least <strong>X</strong>
</li>
<li>To use the coupon, your order subtotal must not exceed <strong>Y</strong>
</li>
<li>Sorry, the coupon you entered cannot be applied to the items in your cart</li>
<li>Sorry, the coupon you entered is not valid for your membership level. Contact the administrator</li>
<li>There is no such a coupon, please check the spelling: <strong>X</strong>
</li>
</ul>

      </div>

      <!-- mobile only -->
      <div id="mobile-header">
        <a class="menu-button"></a>
        <a class="logo" href="/graphql-api-docs">

        </a>
      </div>
      <div id="mobile-shade"></div>

    </div>

  </body>
</html>
